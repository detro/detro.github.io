<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link type="application/atom+xml" rel="alternate" href="https://ivandemarino.me/atom.xml" title="Too much coffee, too little time" />

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <!-- Third Party CSS -->
        <link href="/css/thirdparty/purecss-combo.min.css" rel="stylesheet">
        <link href="/css/thirdparty/font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <!--[if IE 7]>
            <link href="/css/thirdparty/font-awesome/css/font-awesome-ie7.min.css" rel="stylesheet" >
        <![endif]-->

        <!-- Theme CSS -->
        <link rel="stylesheet" href="/css/leo.css">

        <!-- Utility JS -->
        <script type="text/javascript" src="/js/normalize.js"></script>

        
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-136869-11"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

              gtag('config', 'UA-136869-11');
            </script>
        

        
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-K0JQTBH0J9"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

              gtag('config', 'G-K0JQTBH0J9');
            </script>
        

        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Thinking out aloud: a JavaScript based console? | Too much coffee, too little time</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Thinking out aloud: a JavaScript based console?" />
<meta name="author" content="detro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the last month or two I started contributing to PhantomJS: PhantomJS logo PhantomJS is a headless WebKit with JavaScript API. It has fast and native support for various web standards: DOM handling, CSS selector, JSON, Canvas, and SVG. PhantomJS is an optimal solution for headless testing of web-based applications, site scraping, pages capture, SVG renderer, PDF converter and many other use cases. The project is really interesting and we are seeing a steady growth in terms of: Number of users Number of posts/questions/answers on the official Google group Number of contribution The mind behind PhantomJS is Ariya Hidayat, a brilliant guy that I first met when he was still working for Trolltech/Nokia. I will not spend a lot of time here explaining why it’s idea is so great: for that there is the official wiki. To share some awesomeness, here is my favourite example. Do you want to know what’s the weather like in London from your command line? Type something like this:" />
<meta property="og:description" content="In the last month or two I started contributing to PhantomJS: PhantomJS logo PhantomJS is a headless WebKit with JavaScript API. It has fast and native support for various web standards: DOM handling, CSS selector, JSON, Canvas, and SVG. PhantomJS is an optimal solution for headless testing of web-based applications, site scraping, pages capture, SVG renderer, PDF converter and many other use cases. The project is really interesting and we are seeing a steady growth in terms of: Number of users Number of posts/questions/answers on the official Google group Number of contribution The mind behind PhantomJS is Ariya Hidayat, a brilliant guy that I first met when he was still working for Trolltech/Nokia. I will not spend a lot of time here explaining why it’s idea is so great: for that there is the official wiki. To share some awesomeness, here is my favourite example. Do you want to know what’s the weather like in London from your command line? Type something like this:" />
<link rel="canonical" href="https://ivandemarino.me/2011/05/06/Thinking-out-aloud-a-JavaScript-based-console" />
<meta property="og:url" content="https://ivandemarino.me/2011/05/06/Thinking-out-aloud-a-JavaScript-based-console" />
<meta property="og:site_name" content="Too much coffee, too little time" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-05-05T21:45:56+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Thinking out aloud: a JavaScript based console?" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"detro"},"dateModified":"2011-05-05T21:45:56+01:00","datePublished":"2011-05-05T21:45:56+01:00","description":"In the last month or two I started contributing to PhantomJS: PhantomJS logo PhantomJS is a headless WebKit with JavaScript API. It has fast and native support for various web standards: DOM handling, CSS selector, JSON, Canvas, and SVG. PhantomJS is an optimal solution for headless testing of web-based applications, site scraping, pages capture, SVG renderer, PDF converter and many other use cases. The project is really interesting and we are seeing a steady growth in terms of: Number of users Number of posts/questions/answers on the official Google group Number of contribution The mind behind PhantomJS is Ariya Hidayat, a brilliant guy that I first met when he was still working for Trolltech/Nokia. I will not spend a lot of time here explaining why it’s idea is so great: for that there is the official wiki. To share some awesomeness, here is my favourite example. Do you want to know what’s the weather like in London from your command line? Type something like this:","headline":"Thinking out aloud: a JavaScript based console?","mainEntityOfPage":{"@type":"WebPage","@id":"https://ivandemarino.me/2011/05/06/Thinking-out-aloud-a-JavaScript-based-console"},"url":"https://ivandemarino.me/2011/05/06/Thinking-out-aloud-a-JavaScript-based-console"}</script>
<!-- End Jekyll SEO tag -->

    </head>

    <body>
        <div id="layout" class="pure-g-r">

            <div id="sidebar" class="pure-u">
                <a id="toggle-navigation" href="#"><i class="icon-reorder"></i></a>

                <header id="header">

                    <hgroup>
                        <h1><a href="https://ivandemarino.me/">Too much <strong>coffee</strong><br/>too little <strong>time</strong></a></h1>
                        <h2>Ivan <strong>De Marino</strong></h2>
                    </hgroup>

                    <nav id="navigation">
                        
                            <ul id="internal-links">
                                
                                    <li class=""><a href="https://ivandemarino.me/">blog</a></li>
                                
                                    <li class=""><a href="https://ivandemarino.me/projects">projects</a></li>
                                
                                    <li class=""><a href="https://ivandemarino.me/about-me">about me</a></li>
                                
                                    <li class=""><a href="https://ivandemarino.me/archive">archive</a></li>
                                
                            </ul>
                        

                        
                            <ul id="rel-me-links">
                                
                                    <li><a rel="me" href="https://twitter.com/detronizator" target="_blank"><i class="icon-twitter"></i></a></li>
                                
                                    <li><a rel="me" href="https://github.com/detro" target="_blank"><i class="icon-github"></i></a></li>
                                
                                    <li><a rel="me" href="https://linkedin.com/in/ivandemarino" target="_blank"><i class="icon-linkedin"></i></a></li>
                                
                                    <li><a rel="me" href="https://ivandemarino.me/atom.xml" target="_blank"><i class="icon-rss"></i></a></li>
                                
                                    <li><a rel="me" href="https://ivandemarino.me/sitemap.xml" target="_blank"><i class="icon-sitemap"></i></a></li>
                                
                            </ul>
                        
                    </nav>

                </header>
            </div>

            <div id="main" class="pure-u-1">

                <div id="content">
                    
<article class="entry full pure-u-1">
    <header>
        <h1 class="title">
            
                Thinking out aloud: a JavaScript based console?
            
        </h1>
        
            <ul class="meta">
                
                    <li>
                        <i class="icon-calendar"></i>
                        <time datetime="2011-05-05">Thursday, 05 May 2011</time>
                    </li>
                

                
                    <li>
                        <i class="icon-tags"></i>
                        code &bull; console &bull; qt &bull; phantomjs &bull; javascript &bull; idea &bull; project &bull; coffeescript &bull; source &bull; example
                    </li>
                

                
                    <li>
                        <i class="icon-time"></i>
                        624 words
                    </li>
                
            </ul>
        
    </header>
    
        <div class="body">
            
                <p>In the last month or two <a href="https://github.com/detro/phantomjs">I started contributing</a> to <a href="http://www.phantomjs.org">PhantomJS</a>:</p>
<div class="img">
<img src="http://www.openclipart.org/image/800px/svg_to_png/lemmling_Cartoon_ghost.png" width="400" alt="PhantomJS logo" />
PhantomJS logo
</div>

<blockquote>
PhantomJS is a headless WebKit with JavaScript API. It has fast and native support for various web standards: DOM handling, CSS selector, JSON, Canvas, and SVG.

PhantomJS is an optimal solution for headless testing of web-based applications, site scraping, pages capture, SVG renderer, PDF converter and many other use cases.
</blockquote>

<p>The project is really interesting and we are seeing a steady growth in terms of:</p>

<ul>
  <li>Number of users</li>
  <li>Number of posts/questions/answers on the <a href="https://groups.google.com/forum/#!forum/phantomjs">official Google group</a></li>
  <li>Number of <a href="https://github.com/ariya/phantomjs/commits/master">contribution</a></li>
</ul>

<p>The mind behind PhantomJS is <a href="http://ariya.blogspot.com/">Ariya Hidayat</a>, a brilliant guy that I first met when he was still working for Trolltech/Nokia. I will not spend a lot of time here explaining why it’s idea is so great: for that there is <a href="http://code.google.com/p/phantomjs/w/list">the official wiki</a>.</p>

<p>To share some awesomeness, here is my favourite example. <em>Do you want to know what’s the weather like in London from your command line?</em> Type something like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>phantomjs examples/weather.js London, UK

City: London, UK
Current condition: Clear
Temperature: 61 F
Humidity: 45%
Wind: N at 4 mph

Thu: 52-66 F  Partly Sunny
Fri: 57-72 F  Partly Sunny
Sat: 55-72 F  Partly Sunny
Sun: 50-70 F  Chance of Rain
</code></pre></div></div>

<p>How does that work? Here is the PhantomJS script source:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="nx">phantom</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">length</span> <span class="nx">is</span> <span class="mi">0</span>
    <span class="nx">city</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Mountain View</span><span class="dl">'</span>
    <span class="k">if</span> <span class="nx">phantom</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nx">city</span> <span class="o">=</span> <span class="nx">phantom</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span>
    <span class="nx">phantom</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">city</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">"</span><span class="s2">Loading #{ city }</span><span class="dl">"</span>
    <span class="nx">phantom</span><span class="p">.</span><span class="nx">open</span> <span class="nb">encodeURI</span> <span class="dl">"</span><span class="s2">http://www.google.com/ig/api?weather=#{ city }</span><span class="dl">"</span>
<span class="k">else</span>
    <span class="k">if</span> <span class="nx">phantom</span><span class="p">.</span><span class="nx">loadStatus</span> <span class="nx">is</span> <span class="dl">'</span><span class="s1">fail</span><span class="dl">'</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">'</span><span class="s1">Unable to access network</span><span class="dl">'</span>
    <span class="k">else</span>
        <span class="k">if</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">problem_cause</span><span class="dl">'</span><span class="p">).</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">"</span><span class="s2">No data available for #{ phantom.state }</span><span class="dl">"</span>
        <span class="k">else</span>
            <span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="o">-&gt;</span>
                <span class="nx">e</span> <span class="o">=</span> <span class="nx">e</span> <span class="nx">or</span> <span class="nb">document</span>
                <span class="nx">el</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">querySelector</span> <span class="nx">s</span>
                <span class="k">if</span> <span class="nx">el</span> <span class="nx">then</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">value</span> <span class="k">else</span> <span class="kc">null</span>

            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">''</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">'</span><span class="s1">City: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">data</span> <span class="dl">'</span><span class="s1">weather &gt; forecast_information &gt; city</span><span class="dl">'</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">'</span><span class="s1">Current condition </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">data</span> <span class="dl">'</span><span class="s1">weather &gt; current_conditions &gt; condition</span><span class="dl">'</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">'</span><span class="s1">Temperature: </span><span class="dl">'</span> <span class="o">+</span> <span class="nf">data</span><span class="p">(</span><span class="dl">'</span><span class="s1">weather &gt; current_conditions &gt; temp_f</span><span class="dl">'</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> F</span><span class="dl">'</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">data</span> <span class="dl">'</span><span class="s1">weather &gt; current_conditions &gt; humidity</span><span class="dl">'</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">data</span> <span class="dl">'</span><span class="s1">weather &gt; current_conditions &gt; wind_condition</span><span class="dl">'</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">''</span>

            <span class="nx">forecasts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span> <span class="dl">'</span><span class="s1">weather &gt; forecast_conditions</span><span class="dl">'</span>
            <span class="k">for</span> <span class="nx">f</span> <span class="k">in</span> <span class="nx">forecasts</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="dl">"</span><span class="s2">#{ data 'day_of_week', f }: </span><span class="dl">"</span> <span class="o">+</span>
                            <span class="dl">"</span><span class="s2">#{ data 'low', f }-</span><span class="dl">"</span> <span class="o">+</span>
                            <span class="dl">"</span><span class="s2">#{ data 'high', f } F  </span><span class="dl">"</span> <span class="o">+</span>
                            <span class="dl">"</span><span class="s2">#{ data 'condition', f }</span><span class="dl">"</span>

    <span class="nx">phantom</span><span class="p">.</span><span class="nf">exit</span><span class="p">()</span>
</code></pre></div></div>

<p>This scripts uses the <em>undocumented</em> <a href="http://www.google.com/search?sourceid=chrome&amp;ie=UTF-8&amp;q=google+api+weather#sclient=psy&amp;hl=en&amp;safe=off&amp;source=hp&amp;q=google+weather+api&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;pbx=1&amp;bav=on.2,or.r_gc.r_pw.&amp;fp=ee59edf59cfa0598">Google Weather API</a>. Nothing special given <em>nowdays</em> Javascript… but this is bring the result to your CLI! And yep, PhantomJS supports <strong>Coffee Script</strong>, as well as Javascript.</p>

<p>Isn’t this enough to make your eyes sparkly?</p>

<h2 id="a-javascript-based-console">a JavaScript based console?</h2>
<p>Anyway, I’m not here to show what’s available. I’m here to throw an idea out.</p>

<p>PhantomJS is based on the super-awesome Qt. And Qt provides a <strong>superb</strong> API set. The one that makes PhantomJS possible is <a href="http://trac.webkit.org/wiki/QtWebKit">QtWebKit</a>, a <a href="http:///webkit.org">WebKit</a> flavour that is developed side by side with the Google Chrome and the Apple Safari WebKits, on <a href="http://trac.webkit.org/">the official WebKit repo</a>. <a href="http://doc.qt.nokia.com/latest/qtwebkit.html">QtWebKit API</a> make it extremely easy to build software based on WebKit.</p>

<p>Qt also provides other great modules, and one of them is <a href="http://doc.qt.nokia.com/latest/qtscript.html">QtScript</a>. Based on? Yes, it’s based on Javascript! Actually, it wraps in a great API the “standard” <a href="http://www.webkit.org/projects/javascript/">WebKit JavascriptCode</a>.</p>

<p>So, if you do <em>1+1</em> what happens? <strong>PhantomJS can become a fully fledged Javascript interpreter!</strong> The WebPage could just be an object to manipulate as a “resource”, like any other object. The developer could do thinks like:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">page</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">WebPage</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">page</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="dl">"</span><span class="s2">www.google.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">page</span><span class="p">.</span><span class="nf">input</span><span class="p">(</span><span class="dl">"</span><span class="s2">Lady Gaga</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">#inputTextField</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">page</span><span class="p">.</span><span class="nf">click</span><span class="p">(</span><span class="dl">"</span><span class="s2">#submitSearch</span><span class="dl">"</span><span class="p">);</span>
<span class="p">...</span>
<span class="kd">var</span> <span class="nx">rasterizer</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">Rasterizer</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">rasterizer</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="nx">page</span><span class="p">,</span> <span class="dl">"</span><span class="s2">~/ladyGagaSearchResult.png</span><span class="dl">"</span><span class="p">);</span>
<span class="p">...</span>
</code></pre></div></div>

<p>Do you see where I’m heading here?</p>

<p>Put into the picture the <a href="http://www.commonjs.org/">CommonJS</a> specs, still cooking, and you can imagine JavaScript reaching places that no one would have imagined few years ago.</p>

<p>We are discussing this <a href="https://groups.google.com/d/topic/phantomjs/0lOnBOL1oV8/discussion">here on the official group</a>. Come on, join in?</p>

            
        </div>
    
</article>


                </div>

                <footer id="footer">
                    
                        <span>Hosted on <a href="http://pages.github.com/" target="_blank">GitHub Pages</a></span>
                    
                    
                        <span>Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a></span>
                    
                    
                    
                        <span>Licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a></span>
                    
                </footer>

            </div>
        </div>

        <script>
            // Registering "click" handler for "#toggle-navigation"
            normalize.elementAddEventListener(document.getElementById("toggle-navigation"),
                "click",
                function(e) {
                    var navEl = document.getElementById("navigation");
                    navEl.classList.toggle("open");
                    e.preventDefault();
                });
        </script>
    </body>
</html>
