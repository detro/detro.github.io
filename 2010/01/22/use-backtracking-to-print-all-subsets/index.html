<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Use Backtracking to print all Subsets</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Considering yourself perfectible makes you perfect - Ivan De Marino</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Use Backtracking to print all Subsets</h2>
<p class="meta">22 Jan 2010</p>

<div class="post">
<p>I&#39;m &quot;studying&quot; this algorithmic technique: <a href="http://en.wikipedia.org/wiki/Backtracking">Backtracking</a>. This is an algorithmic approach to problem solution that I trust every good Computer Scientist already uses; but taking a <a href="http://www.algorist.com/">good theo-practical look</a> at it is something better.</p>

<div class="img">
<img src="http://upload.wikimedia.org/wikipedia/commons/2/2c/Depthfirst.png" alt="A Backtracking Tree" width="200"/>
A Backtracking Tree
</div>

<p>I believe you can find enough informations about it online (the 2 links I provided are more than enough), so I&#39;ll go straight to the problem.</p>

<h2>Problem definition</h2>

<p>Given an integer <code>n</code>, and the set <code>S = { 1 ... n }</code>, calculate (print) all the possible subsets of <code>S</code>. For example, for <code>n = 1</code>, all the possible subsets are <code>{ 1 }</code> and <code>{ }</code> (empty set). For <code>n = 2</code>, all the possible subsets are: <code>{ 1 2 } { 1 } { 2 } { }</code>. In general, for the set made of the first <code>n Integers</code>, the number of possible subsets is <code>2<sup>n</sup></code>.</p>

<h2>Approaching the problem</h2>

<p>A way to describe a possible subset is an <strong>array of <code>n</code> elements, one for every integers; every element in the array will have value <code>TRUE</code> if the correspondent integers is part of the subset, <code>FALSE</code> otherwise</strong>.</p>

<p>Why the Backtracking then? Because the backtracking technique is designed to generate every possible &quot;candidate solution&quot; once. If we design the algorithm smartly, we can get the backtracking logic to work for us and generate all the possible subsets.</p>

<p>Are you are asking yourself: <em>&quot;isn&#39;t this a bit of a stretching of the backtracking approach?&quot;</em>. I believe it is: the code could be made way smaller, even though it would have the same complexity. We are going to execute the backtracking, designing the algorithm so it will never stop until it tried every possible solution. No &quot;intermediate stopping condition&quot; then.</p>

<h2>Solution</h2>

<p>Give a good look at the <strong><code>void backtrack(int *curr<em>sol, int curr</em>sol_size, int input)</code></strong>: it works as a <strong><em>&quot;skeleton&quot;</em></strong> for <em>generic backtracking</em> algorithms. I&#39;m going to use it in the future as well: I&#39;m going to have fun to implement a <a href="http://en.wikipedia.org/wiki/Sudoku">Sudoku</a> solver ASAP (probably this weekend). Why? Because I suck at Sudoku: never got into it very much to learn how to play :-P.</p>

<p>Anyway, here is the code</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="c1">// Fake boolean values</span>
<span class="cp">#define TRUE    (1)</span>
<span class="cp">#define FALSE   (0)</span>

<span class="c1">// Candidates used at every recursive call</span>
<span class="cp">#define MAX_CANDIDATES 2</span>

<span class="c1">// Define the &quot;bool&quot; type using &quot;short int&quot;</span>
<span class="k">typedef</span> <span class="kt">short</span> <span class="kt">int</span> <span class="kt">bool</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">finished</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>

<span class="kt">bool</span> <span class="nf">reject</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span> <span class="c1">// EMPTY for now</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">accept</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">curr_sol_size</span> <span class="o">==</span> <span class="n">input</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">output</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">static</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[ &quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">curr_sol_size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">curr_sol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">TRUE</span> <span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">extend_solution</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">candidates</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">num_candidates</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Only 2 possibilities: the element is take or not taken</span>
    <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
    <span class="n">candidates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="o">*</span><span class="n">num_candidates</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">try</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// EMPTY for now</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">revert</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// EMPTY for now</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">backtrack</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">curr_sol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">candidates</span><span class="p">[</span><span class="n">MAX_CANDIDATES</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">num_candidates</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">reject</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span> <span class="c1">// Not worth completing</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">accept</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">output</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span> <span class="c1">// Found! Print it</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="o">++</span><span class="n">curr_sol_size</span><span class="p">;</span> <span class="c1">// Increase solution size</span>

        <span class="c1">// Generate solution extension</span>
        <span class="n">extend_solution</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num_candidates</span><span class="p">);</span>
        <span class="c1">// Try every candidates just generated</span>
        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_candidates</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">curr_sol</span><span class="p">[</span><span class="n">curr_sol_size</span><span class="p">]</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

            <span class="n">try</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>

            <span class="n">backtrack</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>

            <span class="n">revert</span><span class="p">(</span><span class="n">curr_sol</span><span class="p">,</span> <span class="n">curr_sol_size</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">finished</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="c1">// Early termination</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_all_subset_from_1_to</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="o">*</span><span class="n">sol</span><span class="p">;</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
    <span class="n">backtrack</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">free</span> <span class="p">(</span><span class="n">sol</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">input</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="k">else</span> <span class="k">return</span> <span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>

    <span class="n">print_all_subset_from_1_to</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2>Complexity</h2>

<p>Time Complexity? Actually, I believe we are talking about a very complex algorithm here: there are <strong>2<sup>n</sup></strong> different subsets here, but to generate everyone of them, the algorithm has to go deep down in every branch of the Backtracking tree. And, given that the depth of a branch is exactly <strong>n</strong> (because is when the printing actually happens), I believe here we have a <strong>O(n * 2^n)</strong> complexity; pretty big. But I could be wrong, so if any <a href="http://en.wikipedia.org/wiki/Big_O_notation">Big-O notation</a> expert is out there, please advice.</p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
