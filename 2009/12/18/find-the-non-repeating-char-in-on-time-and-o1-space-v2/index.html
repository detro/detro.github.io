<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Find the non repeating char in O(n) time and O(1) space - v2</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Considering yourself perfectible makes you perfect - Ivan De Marino</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Find the non repeating char in O(n) time and O(1) space - v2</h2>
<p class="meta">18 Dec 2009</p>

<div class="post">
<p>My colleague and friend Luca (<a href="http://twitter.com/lucabox">@lucabox</a>) described a better solution to the problem of <em>&quot;<a href="http://www.detronizator.org/2009/12/13/find-the-non-repeating-char-in-on-time-and-o1-space/">Finding the first non repearing char in a string in O(n) time and O(1) space</a>&quot;</em>. It uses smartly the space, making the solution nicer and slicker.
Or we are just 2 geeks that need to give more attention to their girlfriends :P</p>

<h2>Luca&#39;s solution description</h2>

<p>The logic of this solution is based on the usage of an array of unsigned chars.
Every char (assumed to be lowecase) has an associated small byte (1 char = 8 bits), where the bits 0x1 and 0x2 (the 2 least significant) represents, respectively, &quot;<em>present once in the input string</em>&quot; and &quot;<em>present multiple times in the input string</em>&quot;. After the input is &quot;scanned&quot; once, and every letter is marked with the correspondent &quot;<em>presence bit</em>&quot; (once, multiple or none), it get&#39;s scanned a second time to find the first char of the input which has the bit &quot;present once&quot; set to &quot;1&quot;.</p>

<h2>Before I show you the code</h2>

<p>Again, this comes from Luca Colantonio (<a href="http://uk.linkedin.com/in/lucacolantonio">http://uk.linkedin.com/in/lucacolantonio</a>), smart ass that is too lazy to maintain a blog and post it himself (or even implementing himself - he just explained to me at work and I had to code it). Thanks Luca ;)</p>

<p>Now, the code.</p>
<div class="highlight"><pre><code class="c language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>

<span class="cp">#define PRESENCE_ONCE_BIT       0x1</span>
<span class="cp">#define PRESENCE_MULTIPLE_BIT   0x2</span>
<span class="cp">#define NORMALIZE_CHAR(C)       (C-&#39;a&#39;)</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">input_length</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">char_presence_bitmask</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mi">26</span><span class="p">);</span>

    <span class="c1">// Check the Input</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Search for every character &quot;present only once&quot;</span>
    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Avoid use of &quot;strlen&quot;, just to look cooler</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// If the current char is not already marked as &quot;present multiple times&quot;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">&amp;</span> <span class="n">PRESENCE_MULTIPLE_BIT</span><span class="p">)</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// It it is already marked as &quot;present once&quot;</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">&amp;</span> <span class="n">PRESENCE_ONCE_BIT</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// Then mark it as &quot;present multiple times&quot; and unmark it&#39;s &quot;present once&quot; bits</span>
                    <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">|=</span> <span class="n">PRESENCE_MULTIPLE_BIT</span><span class="p">;</span>
                    <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">PRESENCE_ONCE_BIT</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="c1">// Otherwise, mark it as &quot;present once&quot;</span>
                    <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">|=</span> <span class="n">PRESENCE_ONCE_BIT</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="c1">// Store the input length to make next iteration easier</span>
            <span class="n">input_length</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Look for the first char that is marked as &quot;present only once&quot; =&gt; that&#39;s the solution</span>
    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">input_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">char_presence_bitmask</span><span class="p">[</span><span class="n">NORMALIZE_CHAR</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">&amp;</span> <span class="n">PRESENCE_ONCE_BIT</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;=== FINAL RESULT: %c ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;=== FINAL RESULT: no char appears only once ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
